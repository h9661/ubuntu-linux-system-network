# 00 개요

시스템에서는 사용자가 실행한 프로세스 외에도 시스템 관리, 메모리 관리, 네트워크 접속 관리 등 다양한 프로세스가 돌아가고 있다.
시스템 관리자는 이러한 프로세스 중에서 비정상적이거나 불필요한 프로세스를 찾아내어 종료할 줄 알아야 한다. 따라서 프로세스 관리 방법에 대해서 이 장에서 배워보도록 하자.

# 01 프로세스 개념

프로세스는 실행 중인 프로그램이다.

## 1.1 프로세스의 부모-자식 관계

`systemd`, `kthreadd` 이외의 모든 프로세스는 부모 프로세스를 가진다. 부모 프로세스는 자식 프로세스를 생성할 수 있으며, 자식 프로세스는 부모 프로세스의 소유가 된다.

## 1.2 프로세스 번호

모든 프로세스는 `PID`라는 번호를 부여받는다. `PID`는 `1`부터 시작하여 `32768`까지 부여된다. `PID`는 부모 프로세스가 자식 프로세스를 생성할 때마다 증가한다.

## 1.3 프로세스의 종류

### 데몬 프로세스

데몬 프로세스는 사용자가 직접 실행하는 것이 아니라 시스템이나 다른 프로세스에 의해 실행되는 프로세스이다. 데몬 프로세스는 사용자가 로그인하지 않은 상태에서도 실행되며, 시스템이 종료될 때까지 실행된다. 특정 이벤트를 처리하는 프로세스라고 말할 수 있겠다. 예를 들어, `ssh` 접속 이벤트가 발생하면 `sshd` 데몬이 실행되어 `ssh` 접속을 처리한다.

### 고아 프로세스

고아 프로세스는 부모 프로세스가 종료되었지만 자식 프로세스가 종료되지 않은 프로세스이다. 고아 프로세스는 `init` 프로세스가 책임지고 종료시킨다.

### 좀비 프로세스

좀비 프로세스는 자식 프로세스가 종료되었지만, 부모 프로세스가 종료된 자식 프로세스의 정보를 아직 수집하지 않은 상태이다. 계속해서 정보를 수집하지 않고 좀비 프로세스가 늘어나면 시스템에 부하가 걸린다. 부모 프로세스에게 `SIGHLD` 시그널을 보내어 좀비 프로세스를 종료하게 하거나 부모 프로세스를 강제 종료시켜 좀비 프로세스를 제거할 수 있다.

# 02 프로세스 관리 명령

## 2.1 프로세스 목록 보기

### `ps` 명령

`ps` 명령은 현재 실행 중인 프로세스 목록을 보여주는 명령이다. `ps` 명령은 다음과 같이 사용한다.

```bash
$ ps [옵션]
```

### 프로세스 상세 정보 출력하기 : `-f` 옵션

`ps -f` 명령은 프로세스의 상세 정보를 출력한다. `ps -f` 명령은 다음과 같이 사용한다.

```bash
$ ps -f

UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0  2019 ?        00:00:01 /sbin/init
root         2     0  0  2019 ?        00:00:00 [kthreadd]
root         3     2  0  2019 ?        00:00:00 [ksoftirqd/0]
root         5     2  0  2019 ?        00:00:00 [kworker/0:0H]
```

### 터미널에서 실행한 프로세스의 정보 출력하기 : `a` 옵션

`ps a` 명령은 터미널에서 실행한 프로세스의 정보를 출력한다. `ps a` 명령은 다음과 같이 사용한다.

```bash
$ ps a

PID TTY      STAT   TIME COMMAND
  1 ?        Ss     0:01 /sbin/init
  2 ?        S      0:00 [kthreadd]
  3 ?        S      0:00 [ksoftirqd/0]
  5 ?        S<     0:00 [kworker/0:0H]
```

`STAT`은 프로세스의 상태를 나타낸다.

| 상태 | 설명                                                |
| ---- | --------------------------------------------------- |
| `S`  | 프로세스가 실행 중인 상태                           |
| `R`  | 프로세스가 실행 중이지만 실행할 수 있는 상태가 아님 |
| `D`  | 프로세스가 실행 중이지만 입출력을 기다리는 상태     |
| `T`  | 프로세스가 정지된 상태                              |
| `Z`  | 프로세스가 좀비 상태                                |
| `X`  | 프로세스가 종료된 상태                              |
| `s`  | 프로세스가 세션 리더인 상태                         |
| `+`  | 포어그라운드 프로세스 그룹                          |

### 터미널에서 실행한 프로세스의 상세 정보 출력하기 : `a` 옵션과 `u` 옵션

`ps -au` 명령은 터미널에서 실행한 프로세스의 상세 정보를 출력한다. `ps au` 명령은 다음과 같이 사용한다.

```bash
$ ps -au
```

### 프로세스 전체 정보 출력하기 : `-e` 옵션

`ps -e` 명령은 프로세스 전체 정보를 출력한다. `ps -e` 명령은 다음과 같이 사용한다.

```bash
$ ps -e
```

### 특정 사용자의 프로세스 목록 출력하기 : `-u` 옵션

```bash
$ ps -u [사용자 이름]
```

### 특정 프로세스의 정보 출력하기 : `-p` 옵션

```bash
$ ps -p [PID]
```

## 2.2 특정 프로세스 정보 검색하기

### `ps` 명령으로 특정 프로세스 정보 출력하기

`ps` 명령으로 특정 프로세스 정보를 출력할 때는 `grep` 명령을 사용한다. `grep` 명령은 다음과 같이 사용한다.

```bash
$ ps -ef | grep [프로세스 이름]
```

### `pgrep` 명령으로 특정 프로세스 정보 출력하기

`pgrep` 명령은 특정 프로세스의 `PID`를 출력한다. `pgrep` 명령은 다음과 같이 사용한다.

```bash
$ pgrep [옵션] [프로세스 이름]
```

## 2.3 프로세스 종료하기

### 시그널

지원하는 시그널 목록은 `kill -l` 명령으로 확인할 수 있다.

주요 시그널은 다음과 같다.

| 시그널 | 설명                                                                 |
| ------ | -------------------------------------------------------------------- |
| `1`    | `SIGHUP` : 터미널 연결이 끊어졌을 때 발생하는 시그널                 |
| `2`    | `SIGINT` : 프로세스에 인터럽트를 보내서 프로세스를 종료시키는 시그널 |
| `9`    | `SIGKILL` : 프로세스를 강제로 종료시키는 시그널                      |
| `15`   | `SIGTERM` : 프로세스에 종료를 요청하는 시그널                        |

### `kill` 명령으로 프로세스 종료하기

`kill` 명령은 프로세스를 종료시키는 명령이다. `kill` 명령은 다음과 같이 사용한다.

```bash
$ kill [-시그널] [PID]
```

### `pkill` 명령으로 프로세스 종료하기

`pkill` 명령은 프로세스를 종료시키는 명령이다. `pkill` 명령은 다음과 같이 사용한다.

```bash
$ pkill [옵션] [프로세스 이름]
```

### `killall` 명령으로 프로세스 종료하기

`killall` 명령은 프로세스를 종료시키는 명령이다. `killall` 명령은 다음과 같이 사용한다.

```bash
$ killall [옵션] [프로세스 이름]
```

## 2.4 프로세스 관리 도구

### `top` 명령

`top` 명령은 시스템의 상태를 실시간으로 모니터링하는 명령이다. `top` 명령은 다음과 같이 사용한다.

```bash
$ top
```

### 시스템 감시

# 03 포그라운드, 백그라운드 프로세스 작업 제어

# 작업 예약
