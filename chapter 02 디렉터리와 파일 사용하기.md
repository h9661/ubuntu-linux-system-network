# 00 개요

이 장에서는 리눅스에서 디렉터리와 파일을 다루는 명령어를 공부한다. 디렉터리의 계층 구조를 먼저 이해한 후 디렉터리를 이동, 삭제, 생성하는 방법을 알아본다. 또한 정보를 관리하는 단위인 파일의 종류를 살펴보고 파일의 내용을 보는 명령과 파일을 생성, 복사, 이동, 삭제하는 명령을 배운다. 리눅스에서 작업을 수행하려면 필수적으로 디렉터리와 파일을 다룰 수 있어야 한다.

# 01 리눅스 파일의 종류와 특징

리눅스도 유닉스처럼 시스템 관련 정보와 장치를 관리하기 위해 파일을 사용한다.

파일은 관련 있는 정보들의 집합이다. 리눅스는 파일을 효과적으로 다루기 위해 디렉터리를 사용하는데, 디렉터리는 계층 구조를 가지고 있다.

## 1.1 파일의 종류

리눅스에서는 파일의 사용 목적에 따라서 일반 파일, 디렉터리, 심벌릭 링크, 장치 파일로 구분된다.

### 일반 파일

일반 파일은 데이터를 저장하는 데 주로 사용된다. 각종 텍스트 파일, 실행 파일, 이미지 파일 등 리눅스에서 사용하는 대부분의 파일은 일반 파일에 해당한다.

텍스트 파일은 파일 내용을 확인하는 명령어로 확인할 수 있고 편집기를 이용하여 보거나 수정할 수 있다.

실행 파일이나 이미지 파일은 데이터가 바이너리 형태로 저장되어 바이너리 파일이라고도 불린다. 바이너리 파일은 파일 내용을 확인할 수 있는 특정 응용 프로그램이 있어야 확인할 수 있다. 예를 들어, 이미지 파일은 이미지 편집기가 있어야 파일의 내용을 확인할 수 있다.

### 디렉터리

리눅스에서는 디렉터리도 파일로 취급된다. 디렉터리 파일에는 해당 디렉터리에 저장된 파일이나 하위 디렉터리에 대한 정보가 저장된다. 2절에서 디렉터리에 대해 자세히 알아본다.

### 심벌릭 링크

심벌릭 링크는 다른 파일이나 디렉터리를 가리키는 파일이다. 윈도우에서 바로가기 아이콘과 비슷한 개념이다.

### 장치 파일

리눅스에서는 하드디스크나 키보드 같은 각종 장치도 파일로 취급한다. 장치 파일은 리눅스 시스템에 부착된 장치를 관리하기 위한 특수 파일이다. 리눅스 시스템에서 각종 장치를 각종 장치를 관리하기 위해 시스템 관리자는 해당 장치 파일에 접근해야 한다. 대부분의 장치 파일은 `/dev` 디렉터리에 위치한다.

리눅스 명령 중에 파일의 종류를 확인하는 `file` 명령이 있다. 명령을 입력하고 결과를 확인해보자.

```bash
$ file /etc/passwd

/etc/passwd: ASCII text
```

`ASCII text`는 텍스트 파일이라는 의미이다. `ASCII`는 텍스트 파일의 종류를 나타내는 것이고 `text`는 파일 내용을 나타낸다. `/etc/passwd`는 리눅스 시스템에 등록된 사용자 정보를 저장하는 파일이다.

```bash
$ file /bin/bash

/bin/bash: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=f2e7b7b7b2c3a2f8c4c9f2f9b2c1f17b6d3bba8f, stripped
```

`/bin/bash`는 바이너리 파일이다. `ELF 64-bit LSB shared object`는 바이너리 파일의 종류를 나타내는 것이고 `x86-64`는 파일이 실행되는 아키텍처를 나타낸다. `dynamically linked`는 파일이 실행될 때 필요한 라이브러리가 동적으로 링크된다는 의미이다. `interpreter /lib64/ld-linux-x86-64.so.2`는 파일이 실행될 때 필요한 인터프리터를 나타낸다. `for GNU/Linux 3.2.0`은 파일이 실행될 때 필요한 운영체제의 버전을 나타낸다. `BuildID[sha1]=f2e7b7b7b2c3a2f8c4c9f2f9b2c1f17b6d3bba8f`는 파일이 빌드된 시점의 고유한 ID를 나타낸다. `stripped`는 파일이 디버깅 정보를 포함하지 않는다는 의미이다.

## 1.2 디렉터리 계층 구조

리눅스에서는 파일을 효율적으로 관리하기 위해 디렉터리를 계층적으로 구성하는데, 이를 트리 구조라고 한다.

모든 디렉터리의 출발점은 `root` 디렉터리이다.

![디렉터리 구조](https://images.velog.io/images/elena_park/post/a06d9388-f496-4755-a61f-1db5428c25b1/linux_directory_structure.png)

### 루트 디렉터리의 서브 디렉터리

루트 디렉터리 아래에는 기본적으로 위의 그림과 같은 서브 디렉터리가 있다. `cd`, `ls` 명령은 2절에서 다룰 것이다. 리눅스 배포판에 따라 조금씩 차이를 보일 수는 있으나, 대부분 유닉스와의 호환성을 유지하므로 유사한 디렉터리를 가지고 있다.

디럭터리명의 끝에 붙은 `/`은 해당 파일이 디렉터리임을, `@`(앳)은 심벌릭 링크를 뜻한다. 즉 `bin/`은 `bin` 디렉터리가 있음을, `initrd.img@`는 `initrd.img`가 심벌릭 링크임을 나타낸다.

### 작업 디렉터리

리눅스에서는 현재 작업 중인 디렉터리를 작업 디렉터리라고 한다. 작업 디렉터리는 `pwd` 명령으로 확인할 수 있다.

```bash
$ pwd
/home/elena
```

### 홈 디렉터리

리눅스에서는 사용자가 로그인하면 사용자의 홈 디렉터리로 이동한다. 홈 디렉터리는 사용자의 디렉터리로 사용자의 이름과 같은 이름을 가진 디렉터리이다. 홈 디렉터리는 `~`로 표시할 수 있다.

```bash
$ cd ~
$ pwd
/home/elena
```

## 1.3 절대 경로명과 상대 경로명

리눅스에서는 파일의 위치를 나타내는 경로를 사용한다. 경로는 절대 경로와 상대 경로로 나눌 수 있다. 절대 경로명은 루트 디렉터리부터 시작하는 경로명이고 상대 경로명은 작업 디렉터리부터 시작하는 경로명이다.

절대 경로명은 다음과 같은 특징이 있다.

- 루트 디렉터리 `/`로 시작한다.
- 루트 디렉터리부터 시작하여 특정 파일이나 디렉터리의 위치까지 이동하면서 거치게 되는 모든 중간 디렉터리의 이름을 표시한다.
- 특정 위치를 가리키는 절대 경로명은 항상 고정되어 있다.

상대 경로명은 다음과 같은 특징이 있다.

- `/` 이외의 문자로 시작한다.
- 현재 작업 디렉터리를 기준으로 특정 파일이나 디렉터리의 위치까지 이동하면서 거치게 되는 모든 중간 디렉터리의 이름을 표시한다.
- 특정 위치를 가리키는 상대 경로명은 현재 작업 디렉터리가 바뀌면 함께 바뀐다.
- 현재 디렉터리를 기준으로 상위 디렉터리를 가리키는 `..`과 현재 디렉터리를 가리키는 `.`을 사용할 수 있다.

## 1.4 파일과 디렉터리 이름의 규칙

리눅스에서는 파일과 디렉터리의 이름을 지을 때 다음과 같은 규칙을 지켜야 한다.

- 파일과 디렉터리의 이름은 대소문자를 구분한다.
- 파일과 디렉터리의 이름은 숫자와 영문자, 그리고 일부 특수문자인 `.`(마침표), `-`(하이픈), `_`(밑줄)만 사용할 수 있다.
- 파일과 디렉터리의 이름은 `.`(마침표)로 시작할 수 있지만, `.`(마침표)로 시작하는 파일과 디렉터리는 보통 숨김 파일이라고 부른다. 숨김 파일은 `ls` 명령으로 확인할 수 없고 `ls -a` 명령으로 확인할 수 있다.
- 파일과 디렉터리의 이름은 `..`을 포함할 수 있지만, `..`은 상위 디렉터리를 가리키는 특수한 의미를 가진다.
- 파일과 디렉터리의 이름은 공백을 포함할 수 없다.

# 02 디렉터리 사용 명령

리눅스에서는 디렉터리를 효율적으로 관리하기 위해 다양한 명령을 제공한다. 이 장에서는 디렉터리를 생성하고 삭제하는 방법, 디렉터리를 이동하는 방법, 디렉터리의 내용을 확인하는 방법을 알아본다.

## 2.1 현재 디렉터리 확인하기

리눅스에서는 현재 작업 중인 디렉터리를 작업 디렉터리라고 한다. 작업 디렉터리는 `pwd`(print working directory) 명령으로 확인할 수 있다.

```bash
$ pwd
/home/elena
```

## 2.2 디렉터리 이동하기

리눅스에서는 `cd`(change directory) 명령으로 디렉터리를 이동할 수 있다. `cd` 명령은 다음과 같이 사용한다.

```bash
$ cd [디렉터리명]
```

## 2.3 디렉터리 내용 보기

리눅스에서는 `ls`(list) 명령으로 디렉터리의 내용을 확인할 수 있다. `ls` 명령은 다음과 같이 사용한다.

```bash
$ ls [옵션] [파일명]
```

`ls` 명령은 현재 작업 디렉터리의 내용을 보여준다. `ls` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-a` : 숨김 파일을 포함하여 디렉터리의 모든 파일을 보여준다.
- `-l` : 파일의 상세 정보를 보여준다.
- `-F` : 파일의 종류를 표시한다. 디렉터리는 `/`, 실행 파일은 `*`, 심벌릭 링크는 `@`가 표시된다.
- `-R` : 디렉터리의 내용을 재귀적으로 보여준다.
- `-d` : 디렉터리 자체의 정보를 보여준다.
- `-i` : 파일의 inode 번호를 보여준다.
- `-A` : `.`과 `..`을 제외한 모든 파일을 보여준다.
- `-L` : 심벌릭 링크의 실제 파일을 보여준다.

여기서 파일의 상세한 정보를 출력하는 `-l` 옵션에 대해 알아보자. `-l` 옵션은 파일의 상세한 정보를 출력한다. 파일의 상세한 정보는 다음과 같다.

- 파일의 종류와 접근 권한
- 하드 링크의 개수
- 소유자와 소유 그룹
- 파일의 크기
- 파일의 최종 수정 시간
- 파일의 이름

```bash
$ ls -l

-rw-rw-r-- 1 elena elena  0  7월  7 21:58 a.txt
...
```

파일의 접근 권한은 5장에서 자세하게 다룰 것이다. 하드링크에 대해서는 3절에서 살펴본다. 파일의 종류는 다음과 같다.

- `-` : 일반 파일
- `d` : 디렉터리
- `l` : 심벌릭 링크
- `b` : 블록 장치 파일
- `c` : 문자 장치 파일
- `p` : 파이프 파일
- `s` : 소켓 파일

## 2.4 디렉터리 만들기

리눅스에서는 `mkdir`(make directory) 명령으로 디렉터리를 생성할 수 있다. `mkdir` 명령은 다음과 같이 사용한다.

```bash
$ mkdir [옵션] [디렉터리명]
```

`mkdir` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-p` : 디렉터리를 생성할 때 중간 단계의 디렉터리가 없으면 중간 단계의 디렉터리까지 생성한다.
- `-m` : 디렉터리의 접근 권한을 설정한다.

## 2.5 디렉터리 삭제하기

리눅스에서는 `rmdir`(remove directory) 명령으로 디렉터리를 삭제할 수 있다. `rmdir` 명령은 다음과 같이 사용한다.

```bash
$ rmdir [옵션] [디렉터리명]
```

`rmdir` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-p` : 디렉터리를 삭제할 때 중간 단계의 디렉터리가 비어 있으면 중간 단계의 디렉터리까지 삭제한다.

# 03 파일 사용 명령

파일과 관련된 명령에는 파일의 내용을 보는 명령, 파일을 복사하는 명령, 파일을 삭제하고 이동하는 명령, 하드 링크와 심벌릭 링크를 생성하는 명령, 빈 파일을 만드는 명령이 있다. 이러한 명령을 각각 살펴보자.

## 3.1 파일 내용 연속 출력하기

리눅스에서는 `cat`(concatenate) 명령으로 파일의 내용을 연속적으로 출력할 수 있다. `cat` 명령은 다음과 같이 사용한다.

```bash
$ cat [옵션] [파일명]
```

`cat` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-n` : 각 행의 앞에 행 번호를 붙여서 출력한다.
- `-b` : `-n` 옵션과 같이 사용하면 빈 행을 제외하고 행 번호를 붙여서 출력한다.

## 3.2 파일 내용 화면 단위로 출력하기

리눅스에서는 `more` 명령으로 파일의 내용을 화면 단위로 출력할 수 있다. `more` 명령은 다음과 같이 사용한다.

```bash
$ more [옵션] [파일명]
```

`space bar`를 누르면 다음 화면으로 넘어가고 `enter`를 누르면 한 행씩 넘어간다. `/문자열`을 입력하면 해당 문자열을 찾아 이동한다. `q`를 누르면 `more` 명령을 종료한다.

## 3.3 개선된 화면 단위 파일 내용 출력하기

리눅스에서는 `less` 명령으로 파일의 내용을 화면 단위로 출력할 수 있다. `less` 명령은 다음과 같이 사용한다.

```bash
$ less [옵션] [파일명]
```

## 3.4 파일 뒷부분 출력하기

리눅스에서는 `tail` 명령으로 파일의 뒷부분을 출력할 수 있다. `tail` 명령은 다음과 같이 사용한다.

```bash
$ tail [옵션] [파일명]
```

`tail` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-n` : 파일의 뒷부분에서 지정한 행 수만큼 출력한다.
- `-f` : 파일의 내용을 실시간으로 출력한다.

## 3.5 파일 복사하기

리눅스에서는 `cp`(copy) 명령으로 파일을 복사할 수 있다. `cp` 명령은 다음과 같이 사용한다.

```bash
$ cp [옵션] [원본 파일명] [대상 파일명]
```

`cp` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-i` : 대상 파일이 이미 존재할 경우 덮어쓸 것인지 물어본다.
- `-r` : 디렉터리를 복사할 때 사용한다.

## 3.6 파일 이동하고 파일명 바꾸기

리눅스에서는 `mv`(move) 명령으로 파일을 이동하거나 파일명을 바꿀 수 있다. `mv` 명령은 다음과 같이 사용한다.

```bash
$ mv [옵션] [원본 파일명] [대상 파일명]
```

`mv` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-i` : 대상 파일이 이미 존재할 경우 덮어쓸 것인지 물어본다.
- `-b` : 대상 파일이 이미 존재할 경우 백업 파일을 만든다.

## 3.7 파일 삭제하기

리눅스에서는 `rm`(remove) 명령으로 파일을 삭제할 수 있다. `rm` 명령은 다음과 같이 사용한다.

```bash
$ rm [옵션] [파일명]
```

`rm` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-i` : 파일을 삭제할 때 물어본다.
- `-r` : 디렉터리를 삭제할 때 사용한다.

## 3.8 파일 링크

파일 링크는 기존 파일에 새로운 이름을 붙이는 것이다. 복잡한 디렉터리 계층 구조를 포함하여 파일명이 복잡할 경우, 짧게 줄인 다른 이름을 붙여서 간단하게 사용할 때 유용하다. 파일 링크에는 하드 링크와 심벌릭 링크가 있다.

하드 링크는 기존 파일에 새로운 파일명을 추가로 생성하는 것이고, 심벌릭 링크는 원본 파일을 가리키는 새로운 파일을 만드는 것이다. 윈도우의 바로가기와 같다고 생각하면 된다. 파일 링크를 공부하기 이전에 리눅스에서는 파일이 어떻게 관리되는지 살펴보자.

### 리눅스 파일의 구성

리눅스에서는 파일이 `파일명 + inode + 데이터 블록`으로 구성된다. 파일명은 사용자가 파일에 접근할 때 사용하는 파일의 이름이다. inode는 파일에 대한 정보를 가지고 있는 특별한 구조체로서 외부적으로는 번호로 표시되고, 내부적으로는 파일의 종류와 크기, 소유자, 파일 변경 시간, 파일명 등 파일 상세 정보와 데이터 블록 주소가 저장되어 있다. `ls -l` 명령으로 출력되는 정보는 사실 inode에 저장되어 있는 파일 상세 정보이다.

![리눅스 파일의 구성](https://t1.daumcdn.net/cfile/tistory/999E0A445ACFA10810)

파일의 inode 번호는 `ls -i` 명령으로 알 수 있다. `ls -i` 명령은 파일의 inode 번호와 파일명을 출력한다.

```bash
$ ls -i

131 a.txt
...
```

파일명 앞에 출력된 숫자가 파일의 inode 번호이다. 파일명은 다르지만 inode 번호가 같다면 같은 파일이다.

### 하드 링크 만들기: `ln` 명령

하드 링크는 `ln` 명령으로 만든다. 리눅스에서는 파일에 여러 개의 이름을 붙일 수 있는데, 이때 붙이는 파일명을 하드 링크라고 한다. `ln` 명령은 다음과 같이 사용한다.

```bash
$ ln [옵션] [원본 파일명] [대상 파일명]
```

`ln` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-s` : 심벌릭 링크를 생성한다.

기존 파일에 새로운 파일명을 붙여서 하드 링크를 만들어보자. 다음 예에서는 `a.txt`에 대한 하드 링크로 `data1.ln`을 만든다. 하드 링크를 생성하기 전에 `ls -l` 명령을 실행하고, 링크를 만든 후에 다시 실행해서 차이를 확인해보자.

```bash
$ ls -l

-rw-rw-r-- 1 elena elena  0  7월  7 21:58 a.txt
```

```bash
$ ln data1 data1.ln
$ ls -l

-rw-rw-r-- 2 elena elena  0  7월  7 21:58 a.txt
-rw-rw-r-- 2 elena elena  0  7월  7 21:58 data1.ln
```

`ls -i` 명령을 실행하면 `a.txt`와 `data1.ln`의 inode 번호가 같다는 것을 알 수 있다. 즉, `a.txt`와 `data1.ln`은 같은 파일이다. `a.txt`의 내용을 변경하면 `data1.ln`의 내용도 변경된다. 하드 링크는 원본 파일과 동일한 inode 번호를 가지고 있으므로 원본 파일과 동일한 파일이다.

### 소프트 링크 만들기: `ln -s` 명령

심벌릭 링크는 윈도우의 바로가기 파일과 같은 것이다. 어렵지 않으니 넘어가도록 하겠다.

## 파일과 관련된 유용한 명령

파일과 관련된 유용한 명령어는 아주 많지만, 흔히 사용되는 `touch`, `grep`, `find`, `whereis`, `which` 명령을 간단하게 살펴보자.

### 빈 파일 만들기, 수정 시간 변경하기: `touch` 명령

리눅스에서는 `touch` 명령으로 빈 파일을 만들거나 파일의 수정 시간을 변경할 수 있다. `touch` 명령은 다음과 같이 사용한다.

```bash
$ touch [옵션] [파일명]
```

`touch` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-a` : 파일의 접근 시간만 변경한다.
- `-m` : 파일의 수정 시간만 변경한다.
- `-t` : 지정한 시간으로 파일의 접근 시간과 수정 시간을 변경한다.

파일이 존재하지 않으면 빈 파일이 생성되고, 존재하는 파일에 대해서 `touch` 명령을 실행하면 파일의 수정 시간이 변경된다.

### 파일 내용 검색하기: `grep` 명령

리눅스에서는 `grep`(global regular expression print) 명령으로 파일의 내용을 검색할 수 있다. `grep` 명령은 다음과 같이 사용한다.

```bash
$ grep [옵션] [패턴] [파일명]
```

`grep` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-i` : 대소문자를 구분하지 않고 검색한다.
- `-n` : 검색 결과의 앞에 행 번호를 붙여서 출력한다.
- `-v` : 패턴과 일치하지 않는 행만 출력한다.
- `-r` : 디렉터리 내부의 모든 파일을 검색한다.
- `-l` : 지정한 패턴이 포함된 파일명을 출력한다.

### 파일 검색하기: `find` 명령

리눅스에서는 `find` 명령으로 파일을 검색할 수 있다. `find` 명령은 다음과 같이 사용한다.

```bash
$ find [옵션] [경로] [패턴]
```

`find` 명령에는 다양한 옵션이 있으며, 자주 사용하는 옵션은 다음과 같다.

- `-name` : 파일명을 지정한다.
- `-user` : 소유자를 지정한다.
- `-type` : 파일의 종류를 지정한다.
- `-size` : 파일의 크기를 지정한다.
- `-mtime` : 파일의 수정 시간을 지정한다.
- `-exec` : 지정한 명령을 실행한다.

매우 다양한 옵션이 있지만, 기본적인 사용법만 살펴보자. 다음 예는 `/bin` 디렉터리에서 `ls` 파일의 위치를 찾는 것이다.

```bash
$ find /bin -name ls

/bin/ls
```

특정 사용자 계정인 파일을 찾고 싶으면 다음과 같이 `-user` 옵션을 사용한다.

```bash
$ find / -user elena

/home/elena
```

find 명령으로 검색한 모든 파일을 대상으로 동일한 작업을 수행하려면 `-exec`나 `-ok` 옵션을 지정한다. `-exec`와 `\;`사이에 기술된 부분이 찾은 파일에 적용될 명령이다. 찾는 파일의 경로가 `{}` 위치에 삽입된다. 다음 예는 `/tmp` 디렉터리에서 `chanwoo` 사용자의 파일을 모두 삭제하는 것이다.

```bash
$ find /tmp -user chanwoo -exec rm {} \;
```
