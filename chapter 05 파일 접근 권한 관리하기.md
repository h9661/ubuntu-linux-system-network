# 00 개요

리눅스는 기본적으로 여러명이서 사용하는 다중 사용자 시스템이다. 따라서 파일의 정보를 보호하기 위해 접근 권한을 제어하는 것이 필수이다. 이 장에서는 이 방법에 대해서 알아보자.

# 01 파일의 속성

파일을 나타내는 속성에는 8가지가 있다.

1. 파일의 종류
2. 접근 권한
3. 링크 수
4. 소유자
5. 소유 그룹
6. 파일 크기
7. 마지막 수정 시간
8. 파일 이름

```bash
$ ls -l

-rw-r--r-- 1 root root 0  1월  1 00:00 test.txt
```

위와 같이 말이다.

`-`는 일반 파일, `d`는 디렉토리, `l`은 링크 파일을 나타낸다.

# 02 파일 접근 권한

## 2.1 접근 권한의 종류

파일의 접근 권한은 3가지 종류가 있다.

1. 읽기
2. 쓰기
3. 실행

## 2.2 접근 권한의 표기

파일의 접근 권한은 3가지 종류가 있고, 이 3가지 종류는 각각 3가지의 상태를 가질 수 있다. 따라서 총 9가지의 상태를 가질 수 있다.

```bash
$ ls -l

-rw-r--r-- 1 root root 0  1월  1 00:00 test.txt
# 여기서 rw-는 소유자의 읽기, 쓰기 권한을 나타낸다.
# r--는 그룹의 읽기 권한을 나타낸다.
# r--는 기타 사용자의 읽기 권한을 나타낸다.
```

## 2.3 접근 권한 변경 명령

접근 권한을 변경하는 명령은 `chmod`이다.

```bash
$ chmod [옵션] [모드] [파일명]
```

옵션으로는 `-R`이 있는데, 하위 디렉터리까지 모두 변경할 수 있다.

# 03 기호를 이용한 파일 접근 권한 변경

```bash
$ chmod [옵션] [모드] [파일명]

$ chmod u=rwx,g=rx,o=r test.txt
# 소유자는 읽기, 쓰기, 실행 권한을 가진다.

$ chmod u+w test.txt
# 소유자는 쓰기 권한을 가진다.

$ chmod u-x test.txt
# 소유자는 실행 권한을 가지지 않는다.
```

# 04 숫자를 이용한 파일 접근 권한 변경

```bash
$ chmod [옵션] [모드] [파일명]

$ chmod 754 test.txt
# 754 = 111 101 100

$ chmod 777 test.txt
# 777 = 111 111 111
```

# 05 기본 접근 권한 설정

파일이나 디렉터리를 생성할 때 기본 접근 권한이 자동적으로 설정된다. 기본 접근 권한은 리눅스 시스템에 설정된 기본값으로, 이 기본값을 바꾸면 기본 접근 권한도 바꿀 수 있다.

## 5.1 기본 접근 권한 확인하고 변경하기

```bash
$ umask
# 0022

$ umask 0002
```

아무 인자 없이 사용하면 확인, 인자를 주면 변경이다.

### 마스크 값의 의미

마스크 값은 파일이나 디렉터리 생성 시 `부여하지` 않을 권한을 지정해놓은 것을 말한다. 예를 들어 마스크가 `002`라면, `-------w-`가 된다. 이는 기타 사용자에게 쓰기 권한을 부여하지 않는다는 소리이다.

### 마스크 값 변경하기

```bash
$ umask [마스크 값]
```

## 5.2 마스크 값 적용 과정

위에서 설명했다. 마스크 값은 파일이나 디렉터리 생성 시 `부여하지` 않을 권한을 지정해놓은 것을 말한다. 예를 들어 마스크가 `002`라면, `-------w-`가 된다. 이는 기타 사용자에게 쓰기 권한을 부여하지 않는다는 소리이다.

# 06 특수 접근 권한

마스크 값에서 4번째 자리에는 특수 접근 권한이 들어간다. 이 특수 접근 권한은 파일이나 디렉터리에 특별한 기능을 부여한다.

1. 4: SetUID
2. 2: SetGID
3. 1: Sticky Bit

하나하나 알아보자.

## 6.1 SetUID

SetUID는 파일에 부여할 수 있는 특수 접근 권한 중 하나로, 파일을 실행할 때 파일 소유자의 권한으로 실행되도록 한다. 즉, 해당 파일을 실행하면 권한이 해당 파일을 실행한 사람이 아니라, 파일 소유자의 권한을 일시적으로 얻는다.

```bash
$ chmod u+s [파일명]
$ chmod 4755 [파일명]
```

## 6.2 SetGID

이거는 `SetUID`와 비슷하지만 약간 다른게, 파일 소유자의 권한을 부여하는 것이 아니라 파일 소유 그룹의 권한을 부여한다.

```bash
$ chmod g+s [파일명]
$ chmod 2755 [파일명]
```

## 6.3 Sticky Bit

스티키 비트는 위에 두개와 약간 다르다. 스티키 비트는 디렉터리에 설정하며, 디렉터리에 이것이 설정되면 이 디렉터리에 누구나 파일을 생성할 수 있다. 파일은 파일을 생성한 계정으로 소유자가 설정되고 다른 사용자가 생성한 파일은 삭제할 수 없다.

```bash
$ chmod o+t [디렉터리명]
$ chmod 1755 [디렉터리명]
```
